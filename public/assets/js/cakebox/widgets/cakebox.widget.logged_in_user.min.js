var cakeboxWidgetUser=function(t,e){return cakeboxWidget.apply(this,arguments),this.obj=t,this.default_chart_type="table",this.supported_chart_types={table:"Data Table"},this.user_data=[],this.data_api_url="/api/widget/loggedin_user",this.branch_api_url="/api/zone2",this.date_filter_url="/api/datefilters",this.hdrs=["#","","MAC ADDRESS","EMAIL","NAME","GENDER","BIRTHDAY","PHONE","SSID","ACCESS SINCE","LAST ACCESS"],this.fields=["","facebook_id","macaddress","email","name","gender","birthday","phone","ssid","created_at","updated_at"],this.demo_data=[],this.settings=$.extend(!0,this.defaults,e),this.init(),this};cakeboxWidgetUser.prototype=Object.create(cakeboxWidget.prototype),cakeboxWidgetUser.prototype.createUI=function(){var t=this,e=$("<div />").attr("id","widget_"+this.settings.id).addClass("cakebox-widget").appendTo(this.obj),a=$("<h3 />").addClass("handle").appendTo(e);""!==this.settings.chartTitle&&a.text(this.settings.chartTitle);var i=$("<div />").addClass("panel").addClass("panel-flat").appendTo(e),s=$("<div />").addClass("heading-elements").appendTo(a),d=$("<ul />").addClass("icons-list").appendTo(s);if(Object.keys(this.supported_chart_types).length>1){var n=$("<li />").appendTo(d),r=$("<select />").attr("id",this.settings.id+"_charttype").appendTo(n);$.each(this.supported_chart_types,function(e,a){var i=$("<option />").attr("value",e).text(a).appendTo(r);e===t.settings.chartType&&i.attr("selected","selected")}),r.change(function(){t.settings.chartType=$(this).val(),t.validChartType(),t.setChartOption()})}if(null!==this.settings.btn_reload&&($("<li />").html('<a id="'+this.settings.btn_reload.id+'" data-action="reload" title="'+this.settings.btn_reload.title+'"></a>').appendTo(d),$("#"+t.settings.btn_reload.id).click(function(e){e.preventDefault(),t.demo===!1&&t.loadData()})),null!==this.settings.btn_remove&&($("<li />").html('<a id="'+this.settings.btn_remove.id+'" data-action="close" title="'+this.settings.btn_remove.title+'" rel="'+this.settings.id+'"></a>').appendTo(d),$("#"+t.settings.btn_remove.id).click(function(e){e.preventDefault(),null!==t.settings.btn_remove.confirm&&""!==t.settings.btn_remove.confirm?confirm(t.settings.btn_remove.confirm)&&t.removeMe():t.removeMe()})),null!==this.settings.filters&&this.settings.filters.enabled===!0){var o=$("<div />").addClass("panel-heading").appendTo(i),p=$("<div />").addClass("row").appendTo(o),l=$("<div />").addClass("col-md-12").appendTo(p),h=$("<div />").addClass("row").addClass("btn_top").appendTo(l),c=$("<div />").addClass("col-md-6").appendTo(h),g=$("<select />").attr("id",this.settings.filters.branch.id).addClass("form-control").appendTo(c);$("<option />").attr("value","").text("-CHOOSE AREA-").appendTo(g),g.change(function(){var e=$(this).val();$("#"+t.settings.filters.compare.id+" option").css("display","inherit"),""!==e&&$("#"+t.settings.filters.compare.id+" #vcp_"+e).css("display","none");var a=$("#"+t.settings.filters.compare.id).val();e===a&&$("#"+t.settings.filters.compare.id).val(""),t.demo===!1&&t.loadData()});var f=$("<div />").addClass("col-md-6").appendTo(h);$("<select />").attr("id",this.settings.filters.date.id).addClass("form-control").appendTo(f),this.loadBranches(),this.loadFilters()}var u=$("<div />").addClass("panel-body").appendTo(i),v=$("<div />").addClass("row").appendTo(u),b=$("<div />").addClass("table-responsive").appendTo(v);this.settings.fixedHeight===!0&&b.addClass("content-fixed-height"),$("<div />").addClass("chart-loading").attr("id",this.settings.id+"_loading").html('<div><i class="icon-spinner2 spinner"></i> '+this.settings.loading+"</div>").appendTo(b);for(var _=$("<table />").attr("id",this.settings.id).addClass("table").appendTo(b),m=$("<thead />").appendTo(_),T=$("<tr />").appendTo(m),C=0;C<this.hdrs.length;C++){var y=this.hdrs[C];$("<th />").text(y).appendTo(T)}$("<tbody />").appendTo(_)},cakeboxWidgetUser.prototype.initChart=function(){this.setChartOption(!0)},cakeboxWidgetUser.prototype.loadData=function(t){var e=this,a=this.data_api_url,i=!0,s=this.getQueryParameter(t);i&&($("#"+this.settings.id+"_loading").show("fast"),$.post(a,s,function(t){e.user_data=t.data,e.updateChartData()}))},cakeboxWidgetUser.prototype.updateChartData=function(){var t=this,e=t.demo?t.demo_data:t.user_data.series[0],a=$("#"+t.settings.id+" tbody");a.html(""),"undefined"!=typeof e&&"undefined"!=typeof e.data&&$.each(e.data,function(e,i){var s=$("<tr />").appendTo(a);$.each(t.fields,function(t,a){switch(a){case"":0===t&&$("<td />").text(e+1).appendTo(s);break;case"facebook_id":"undefined"!=typeof i[a]&&("1"==i[a]?$("<td />").html('<img src="../../images/dashboard/social/fb.png" width="20" />').appendTo(s):$("<td />").html("&nbsp;").appendTo(s));break;default:"undefined"!=typeof i[a]&&$("<td />").html(i[a]).appendTo(s)}})}),$("#"+this.settings.id+"_loading").hide("fast")},cakeboxWidgetUser.prototype.setDataSeriesFormat=function(){},cakeboxWidgetUser.prototype.refreshChart=function(){this.adjustWidget()},function(t){"use strict";t.fn.cakeboxUsers=function(e){if(this.length>1)return this.each(function(){t(this).cakeboxUsers(e)}),this;var a={id:"logged_in_user",chartType:"table",chartTitle:"LOGGED IN USERS",btn_reload:{id:"user_reload",title:"Reload data"},btn_remove:{id:"user_remove",title:"Remove this chart",confirm:"Please confirm to remove this chart"},filters:{enabled:!1,branch:{id:"user_branch",value:""},compare:null,date:{id:"user_date",value:""}},loading:"Loading"},i=t.extend(!0,a,e),s=new cakeboxWidgetUser(this,i);return this.refreshChart=function(){s.refreshChart()},this.removeChart=function(){s.removeChart()},this}}(jQuery);