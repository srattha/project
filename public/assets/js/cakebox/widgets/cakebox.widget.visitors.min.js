var cakeboxWidgetVisitor=function(t,e){return cakeboxWidget.apply(this,arguments),this.obj=t,this.default_chart_type="bar",this.supported_chart_types={bar:"Bar Chart",line_area:"Line Chart"},this.visitor_data=[],this.data_api_url="/api/widget/visitor",this.branch_api_url="/api/zone2",this.date_filter_url="/api/datefilters",this.settings=$.extend(!0,this.defaults,e),this.init(),this};cakeboxWidgetVisitor.prototype=Object.create(cakeboxWidget.prototype),cakeboxWidgetVisitor.prototype.loadData=function(t){var e=this,i=e.data_api_url,a=!0,r=e.getQueryParameter(t);("undefined"==typeof r.area||"undefined"!=typeof r.area&&(""===r.area||isNaN(r.area)))&&(a=!1),a&&($("#"+e.settings.id+"_loading").show("fast"),$.post(i,r,function(t){e.visitor_data=t.data,e.updateChartData()}))},cakeboxWidgetVisitor.prototype.setDataSeriesFormat=function(){var t=this,e=[],i=[],a=!1;if(t.demo?a=cakeboxChart.getDemoXAxis(t.settings.chartType):"undefined"!=typeof t.visitor_data.xAxis&&t.visitor_data.xAxis.length>0&&(a=cakeboxChart.getXAxis(t.settings.chartType,{data:t.visitor_data.xAxis})),a!==!1&&"undefined"!=typeof t.chart_options.xAxis&&(t.chart_options.xAxis=[],t.chart_options.xAxis=a),this.demo)e=cakeboxChart.getDemoSerie(t.settings.chartType);else{var r=t.visitor_data.series;$.each(r,function(a,r){if(r.data.length>0){var o=0===a?t.settings.chart.color:t.settings.chart.compare.color,s=0===a?t.settings.chart.label.color:t.settings.chart.compare.label.color,n={name:r.name,color:o,txt_color:s},h=cakeboxChart.getSerieFormat(t.settings.chartType,r.data,n);e.push(h),i.push(r.name)}}),"undefined"!=typeof t.chart_options.legend&&"undefined"!=typeof t.chart_options.legend.data&&(t.chart_options.legend.data=[],t.chart_options.legend.data=t.clone(i))}t.chart_options.series=e},function(t){"use strict";t.fn.cakeboxVisitors=function(e){if(this.length>1)return this.each(function(){t(this).cakeboxVisitors(e)}),this;var i={id:"visitor",chartType:"bar",chart:{color:"#0072bc",label:{color:"#000"},compare:{color:"",label:{color:""}}},chartTitle:"VISITORS",fixedHeight:!0,xAxis:{name:"Age",data:[]},yAxis:{format:"{value} visitors",line:{color:"#666"}},grid:{x:100,x2:20,y:85,y2:25},btn_reload:{id:"visitor_reload",title:"Reload data"},btn_remove:{id:"visitor_remove",title:"Remove this chart",confirm:"Please confirm to remove this chart"},filters:{enabled:!0,branch:{id:"visitor_branch",value:5},compare:{id:"visitor_compare",value:""},date:{id:"visitor_date",value:"this_month"}},loading:"Loading"},a=t.extend(!0,i,e),r=new cakeboxWidgetVisitor(this,a);return this.refreshChart=function(){r.refreshChart()},this.removeChart=function(){r.removeChart()},this}}(jQuery);